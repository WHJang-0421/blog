---
title:  "오라클 DB 15: 커서와 예외 처리"
author: "Woohyuk Jang"
draft: false

date: "2023-02-20"
description: ""
categories:
  - cs/db
tags:
  - Blog
---
### 오라클 DB #15: 커서와 예외 처리



이 글은 책 [오라클로 배우는 데이터베이스 입문](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125) 18장을 읽고 정리한 것이다.



1. 커서 (cursor)



* 모든 SQL 명령은 실행하는 과정에서 개별적인 메모리 공간을 사용하게 된다. 이렇게 SQL문을 처리하는 정보를 담은 메모리 공간을 Private SQL Area라 한다.

* 이 Private SQL Area로의 포인터를 커서라고 한다. 메모리 공간을 가리키는 특성 상 전체 데이터가 아니라 한 행을 가리키게 된다.

* 커서에 대한 정보를 속성으로 제공한다.



```

-- 직전에 수행된 FETCH문을 통해 추출된 행이 있는지

커서이름%NOTFOUND

커서이름%FOUND



커서이름%ROWCOUNT -- 현재까지 추출된 행 수

커서이름%ISOPEN

```



2\. 명시적 커서 (explicit cursor)



명시적 커서 사용은 다음의 4단계로 이루어진다:



​ ​ ​​​ ​ ​​​ ​ ​​​ ​a) 커서 선언 (declaration)



​ ​ ​​​ ​ ​​​ ​ ​​​ ​b) 커서 열기 (open)



​ ​ ​​​ ​ ​​​ ​ ​​​ ​c) 데이터 읽어오기 (fetch)



​ ​ ​​​ ​ ​​​ ​ ​​​ ​d) 커서 닫기 (close)



```

DECLARE

  CURSOR 커서이름 IS SQL문 -- declaration

BEGIN

  OPEN 커서이름; -- open

  FETCH 커서이름 INTO 변수; -- fetch

  CLOSE 커서이름; -- close

END;

```



* 보통 커서는 여러 행을 조회하는 경우 사용한다.



```

-- LOOP를 이용하여 여러 행 조회하기

DECLARE

  -- 행 데이터 변수

  DEPT_ROW DEPT%ROWTYPE;



  -- 커서 선언

  CURSOR c1 IS

    SELECT DEPTNO, DNAME, LOC

    FROM DEPT;



BEGIN

  OPEN c1;



  LOOP

    FETCH c1 INTO DEPT_ROW;

    EXIT WHEN c1%NOTFOUND;

    DBMS_OUTPUT.PUT_LINE(DEPT_ROW.DEPTNO);

  END LOOP;

```



```

-- FOR를 이용하여 여러 행 조회하기: 커서 open, fetch, close가 자동으로 되는 장점

DECLARE

  CURSOR c1 IS

    SELECT DEPTNO, DNAME, LOC

    FROM DEPT;

BEGIN

  FOR dept_row IN c1 LOOP

  -- dept_row는 루프 인덱스로, c1이 가리키는 각 행이 저장된다.

    DBMS_OUTPUT.PUT_LINE(dept_row.DEPTNO);

  END LOOP;

END;

```



* 커서에 파라미터를 사용할 수 있다.



```

DECLARE

  SELECT_DEPTNO DEPT.DEPTNO%TYPE;

  CURSOR c1 (p_deptno DEPT.DEPTNO%TYPE) IS

    SELECT DEPTNO, DNAME, LOC

    FROM DEPT

    WHERE DEPTNO = p_deptno;

BEGIN

  SELECT_DEPTNO := &INPUT_DEPTNO; -- 사용자에게 input_deptno의 값을 요구

  FOR dept_row IN c1(SELECT_DEPTNO) LOOP

    DBMS_OUTPUT.PUT_LINE(dept_row.LOC);

  END LOOP;

END;

```



3\. 묵시적 커서



* DML 명령어나 SELECT INTO 등의 명령어가 실행될 때 자동으로 생성되는 커서이다.

* 묵시적 커서의 이름은 SQL 키워드라고 생각하면 된다.

* 모든 묵시적 커서는 한 행만을 담고 있고, 알아서 닫혀서 SQL%ISOPEN은 항상 false다.



4\. 예외 처리



* 오라클에서의 예외 처리는 제한적이다. finally에 해당하는 부분은 없다고 생각하면 된다.

* 오라클의 예외는 내부 예외 (internal exceptions)와 사용자 정의 예외 (user defined exceptions)로 나뉜다. 내부 예외 중에는 사전 정의된 것도 있고 (predefined name exceptions - 예외번호와 이름 둘다 있음) 이름 없는 예외 (unnamed exceptions - 예외번호만 있음)도 있다.



```

DECLARE

  -- 이름 없는 내부 예외에 이름 붙이는 법

  예외명1 EXCEPTION;

  PRAGMA EXCEPTION_INIT(예외명1, 예외 번호);



  -- 사용자 정의 예외를 처리하는 방법

  사용자 예외명 EXCEPTION;

BEGIN

  -- 사용자 정의 예외를 발생시키고 싶을 때

  RAISE 사용자 예외명;



EXCEPTION

  WHEN 예외명A [OR 예외명B...] THEN

    할일;

  WHEN OTHERS THEN

    할일;

    DBMS_OUTPUT.PUT_LINE('SQLCODE: ' || TO_CHAR(SQLCODE));

    DBMS_OUTPUT.PUT_LINE('SQLERRM: ' || SQLERRM);

END;

```



5\. 참고자료 / 더 깊이 파보고 싶다면…



[**Do it! 오라클로 배우는 데이터베이스 입문**\

*현업 프로그래머이자 강사인 저자가 수많은 프로젝트 경험을 살려 실무에서 진짜 필요한 기본기를 중심으로 내용을 구성했다. 본문 내용은 비전공자도 알기 쉽게 도해와 비유로 풀어 썼고 427개의 예제는 실무에서 ...*&#x77;ww.aladin.co.kr](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125 "https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125")[](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125)



[**17 PL/SQL Cursor (커서)**\

*1. SQL 커서란?오라클 서버에서는 사용자의 SQL 문장을 처리하는 모든 서버 프로세스는 SQL 문을 실행할 때마다 처리를 위한 개별적인 메모리 공간을 사용한다.커서란 이 개별 메모리 공간에 있는 데이터를 사람이…*&#x61;boutdb.tistory.com](https://aboutdb.tistory.com/141 "https://aboutdb.tistory.com/141")[](https://aboutdb.tistory.com/141)



[**데이터베이스에서의 커서 (Cursor)**\

*1. 개념설명커서 (Cursor)는 컴퓨터로 문서를 작성해 본 사람이라면 누구나 알고 있는 용어이다. 화면에서 현재 사용자의 위치를 나타내며 깜빡거리는 막대기가 바로 커서이다.데이터베이스에서의 커서 또한 유사한…*&#x6E;arwhals.tistory.com](https://narwhals.tistory.com/4 "https://narwhals.tistory.com/4")[](https://narwhals.tistory.com/4)



By [Woohyuk Jang](https://medium.com/@morrranii) on [February 20, 2023](https://medium.com/p/4b3be8ce1d39).

Exported from [Medium](https://medium.com) on August 26, 2025.
