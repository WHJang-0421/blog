---
title:  "오라클 DB 4: 데이터 그룹화"
author: "Woohyuk Jang"
draft: false

date: "2023-02-17"
description: ""
categories:
  - cs/db
tags:
  - Blog
---
### 오라클 DB #4: 데이터 그룹화



이 글은 [오라클로 배우는 데이터베이스 입문](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125) 7장을 읽고 정리한 것이다.



1. 다중행 함수



오라클 DB #3에서 다뤘듯이, 다중행 함수는 여러 행을 입력으로 받아 하나의 결과를 출력하는 함수이다.



* SUM(열): 합. SUM(DISTINCT 열)은 열에서 유일한 값들의 합이다.

* COUNT(열): NULL이 아닌 값의 개수. COUNT(\*)는 행의 개수. COUNT(DISTINCT 열)꼴도 쓸 수 있다.

* AVG(열): 평균 값 반환. AVG(DISTINCT 열)도 있다.

* MAX(열): 입력 데이터의 최대값. MAX(DISTINCT 열)도 있지만 의미 없다.

* MIN(열): 입력 데이터의 최소값. MIN(DISTINCT 열)도 있지만 의미 없다.



SUM, AVG는 숫자로 형변환이 가능한 자료형만 입력으로 받고, COUNT는 아무거나 상관 없다. MAX와 MIN은 대소 비교만 가능하면 상관 없다.



2\. GROUP BY절과 그룹화 함수



다중행 함수는 여러 행의 그룹을 받아 하나의 결과를 출력한다. 이렇게 행을 묶어 그룹을 만들 기준을 제시하는 것이 GROUP BY 절이다.



* \<GROUP BY 열1, 열2>와 같이 쓴다. 이 명령은 열1을 기준으로 나눈 그룹을 다시 열 2를 기준으로 나눈다.

* GROUP BY 절에는 다중행 함수를 사용하지 않은 열을 모두 명시한다.



한편, GROUP BY절에 열 대신 그룹화 함수를 사용할 수 있다.



* GROUP BY ROLLUP(열 A, B, C): GROUP BY A, B, C + GROUP BY A, B + GROUP BY A + GROUP BY (nothing)

* GROUP BY CUBE(열 A, B, C): GROUP BY (A, B, C + A, B + B, C + C, A + A + B + C + nothing)

* GROUP BY GROUPING SETS(열 A,B,C): GROUP BY A + GROUP BY B + GROUP BY C



이렇게 그룹화 함수를 사용하면 문제가 생기는데, A를 집계한 행은 A값이 NULL로 나와서 그냥 원래부터 A값이 NULL인 행과 구분이 안된다. 그래서 구분을 위해 GROUPING 함수를 사용한다.



* GROUPING(열): 해당 행이 입력으로 주어진 열의 그룹화가 이루어진 결과인지.

* GROUPING ID(열들): GROUPING이랑 똑같지만, 그룹화 비트 벡터를 반환한다. 예를 들어 GROUPING ID(A,B)는 A가 집계되고 B가 집계 안 되었으면 2를 반환한다.



3\. HAVING 절



* HAVING \[조건식]

* GROUP BY로 묶은 그룹 중 출력 그룹을 선택한다.

* WHERE절과 유사하지만, 행을 선택하냐 그룹을 선택하냐의 차이. HAVING절에는 다중행 함수를 이용할 수 있다.

* WHERE절에 의한 행의 선택이 HAVING절에 의한 그룹의 선택보다 먼저 일어난다.



4\. 다른 그룹화 함수



* LISTAGG(나열할 열, \[구분자=NULL]) WITHIN GROUP(ORDER BY 열): 각 그룹 내에서 특정 열의 값을 가로로 나열한다.

* PIVOT(값 FOR 열 IN (가능한 열 값 AS 별칭)): 기존 테이블 행을 열로 바꿀 수 있다.

* UNPIVOT(2차원 표 내 데이터 이름 FOR 2차원 표 내 열 이름 IN (2차원 표 내 열 값들)): 2차원 표를 되돌린다.



5\. 참고자료



[**Do it! 오라클로 배우는 데이터베이스 입문**\

*현업 프로그래머이자 강사인 저자가 수많은 프로젝트 경험을 살려 실무에서 진짜 필요한 기본기를 중심으로 내용을 구성했다. 본문 내용은 비전공자도 알기 쉽게 도해와 비유로 풀어 썼고 427개의 예제는 실무에서 ...*&#x77;ww.aladin.co.kr](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125 "https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125")[](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125)



By [Woohyuk Jang](https://medium.com/@morrranii) on [February 17, 2023](https://medium.com/p/e33e048fbdf9).

Exported from [Medium](https://medium.com) on August 26, 2025.
