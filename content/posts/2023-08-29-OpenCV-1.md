---
title:  "이미지 찾기 — OpenCV와 게임 컴퓨터 비전 1"
author: "Woohyuk Jang"
draft: false

date: "2023-08-29"
description: ""
categories:
  - cs/ai
tags:
  - Blog
---
### 이미지 찾기 — OpenCV와 게임 컴퓨터 비전 #1



이 블로그 포스트는 OpenCV를 이용한 이미지 인식의 한 예시로 게임 내 사물 인식을 소개하려 한다. 오늘은 시작하는 느낌으로 간단한 예시 하나만 들려고 한다.



*이 글은&#x20;*[*https://youtu.be/KecMlLUuiE4?feature=shared*](https://youtu.be/KecMlLUuiE4?feature=shared)*를 참고하여 작성했으며, 주로 영상의 번역과 구현 과정에서 나의 경험을 담고 있다.*



1. 오늘 뭘 할까?



![](https://cdn-images-1.medium.com/max/800/1*OUaHN3ttKN3oqklvy-wg6Q.jpeg)



여기에서 template image를 찾으려 한다



![](https://cdn-images-1.medium.com/max/800/1*j27gVtVmVx2YSCtLpiNPwg.jpeg)



template image



위의 두 이미지가 주어졌을 때 (아무 이미지나 상관 없다)



![](https://cdn-images-1.medium.com/max/800/1*L3nazeFJJ0Wt7_L-N1j84g.jpeg)



이렇게 template image의 위치를 찾는 것이 목적이다



2\. OpenCV



OpenCV는 컴퓨터 비전에 자주 사용되는 파이썬 라이브러리이다.



* 다운로드: `pip install opencv-python`

* documentation: [docs.opencv.org](http://docs.opencv.org)에서 나의 버전에 맞는 doxygen HTML을 고른다. 파이썬 모듈의 버전은 파이썬 코드 `(모듈명).__version__` 으로 알 수 있다.



3\. 코드



다음은 전체 코드이다. 설명이 필요한 부분은 다음 섹션에 따로 설명했다.



```

import cv2 as cv

import numpy as np



### just doing the same thing as pyautogui.locateOnScreen()



### load images

arena_img = cv.imread("C:/Temp/2023/game-auto/images/royale-arena.jpg", cv.IMREAD_REDUCED_COLOR_2)

tower_img = cv.imread("C:/Temp/2023/game-auto/images/royale-crowntower.jpg", cv.IMREAD_REDUCED_COLOR_2)

# print(arena_img.dtype)

# print(arena_img.shape)



### template matching

result = cv.matchTemplate(arena_img, tower_img, cv.TM_CCOEFF_NORMED)

min_val, max_val, min_loc, max_loc = cv.minMaxLoc(result) # values are between 0 and 1

print(f"Best match for top left position: {str(max_loc)}")

print(f"Best match confidence: {max_val}")



### threshold and displaying the result

threshold = 0.8

if max_val >= threshold:

    print("found tower")

    

    # draw rectangle to screenshot image

    top_left = max_loc

    bottom_right = (top_left[0] + tower_img.shape[1], top_left[1] + tower_img.shape[0])

    cv.rectangle(arena_img, top_left, bottom_right, color=(0,255,0), thickness=2, lineType=cv.LINE_4)



    # display results

    cv.imshow('Result', arena_img)

    cv.waitKey()



    # save image to file

    cv.imwrite('images/royale-findtower.jpg', arena_img)

else:

    print("couldn't find tower")

```



4\. 코드 설명



```

### load images

arena_img = cv.imread("C:/Temp/2023/game-auto/images/royale-arena.jpg", cv.IMREAD_REDUCED_COLOR_2)

tower_img = cv.imread("C:/Temp/2023/game-auto/images/royale-crowntower.jpg", cv.IMREAD_REDUCED_COLOR_2)

# print(arena_img.dtype)

# print(arena_img.shape)

```



`CV.IMREAD_REDUCED_COLOR_2` 는 color channel의 수를 2로 줄여서 입력을 받는다는 의미이다. 이렇게 하지 않고 영상에서 하라는 대로 따라하면 다음과 같은 오류를 볼 수 있다…



`error: (-215:Assertion failed) (depth == CV_8U || depth == CV_32F) && type == _templ.type() && _img.dims() <= 2 in function ‘cv::matchTemplate'`



`arena_img.dtype` 를 통해 depth를, `arena_img.shape` 을 통해 dims를 알 수 있다. 자세한 내용은 <https://stackoverflow.com/questions/32592950/python-opencv-template-matching-error>를 참고하자.



5\. 참고자료



<https://docs.opencv.org/4.8.0/d4/dc6/tutorial_py_template_matching.html>



<https://stackoverflow.com/questions/32592950/python-opencv-template-matching-error>



By [Woohyuk Jang](https://medium.com/@morrranii) on [August 29, 2023](https://medium.com/p/989d55fb68b9).

Exported from [Medium](https://medium.com) on August 26, 2025.
