---
title:  "오라클 DB 14: 레코드와 컬렉션"
author: "Woohyuk Jang"
draft: false

date: "2023-02-20"
description: ""
categories:
  - cs/db
tags:
  - Blog
---
### 오라클 DB #14: 레코드와 컬렉션



이 글은 [오라클로 배우는 데이터베이스 입문](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125) 17장을 읽고 정리한 것이다.



이 글에서는 복합 자료형을 다룬다. 오라클에서는 여러 데이터를 하나의 변수로 묶을 수 있는 복합 자료형으로 레코드와 컬렉션을 제공한다.



1. 레코드 (Record)



* 다른 자료형을 하나의 변수로 묶은 것. 행/클래스 개념과 비슷하다.



```

-- DECLARE문 안에서

TYPE 레코드이름 IS RECORD(

  변수명 자료형 [NOT NULL] [:=/DEFAULT 값]

);

```



* `테이블%ROWTYPE`으로 얻는 객체가 바로 이 레코드다.

* FOR IN 문으로 테이블을 조회하면 counter 값으로 레코드가 들어가게 된다. 레코드로 INSERT, UPDATE도 할 수 있다.



```

DECLARE

  TYPE EX_ROW IS RECORD(

    col1 EX_TABLE%TYPE NOT NUL,

    col2 NUMBER(3) := 524

  );

  row_from_db EX_ROW;

BEGIN

  FOR i IN (SELECT COL1, COL2 FROM EX_TABLE) LOOP

    row_from_db = i;

    DBMS_OUTPUT.PUT_LINE(row_from_db.col1);



    INSERT INTO EX_TABLE2

    VALUES row_from_db; -- 레코드 이름만 명시하면 됨.



    UPDATE EX_TABLE2

    SET ROW = row_from_db

    WHERE COL2 = row_from_db.col2;

  END LOOP;

END;

```



* 중첩 레코드 (nested record) 사용도 가능하다. 이를 통해 참조 관계를 표현할 수 있다.



```

DECLARE

  TYPE REC_DEPT IS RECORD(

    deptno DEPT.DEPTNO%TYPE,

    dname DEPT.DNAME%TYPE,

    loc DEPT.LOC%TYPE

  );

  TYPE REC_EMP IS RECORD(

    empno EMP.EMPNO%TYPE,

    ename EMP.ENAME%TYPE,

    dinfo REC_DEPT -- 중첩 레코드

  );

  

  emp_rec REC_EMP;

BEGIN

  SELECT E.EMPNO, E.ENAME, D.DEPTNO, D.DNAME, D.LOC

  INTO emp_rec.empno, emp_rec.ename, emp_rec.dinfo.deptno, 

       emp_rec.dinfo.dname, emp_rec.dinfo.loc -- 두개의 마침표 사용

  FROM

    EMP E

    JOIN DEPT D ON (E.DEPTNO = D.DEPTNO)

  WHERE

    E.EMPNO = 7788;



  DBMS_OUTPUT.PUT_LINE(emp_rec.empno || ' works at ' || emp_rec.dinfo.loc);

END;

```



2\. 컬렉션 (Collection)



* 동일한 자료형 여러개를 하나의 변수로 묶은 것. 열/배열 개념과 비슷하다.

* 컬렉션에는 연관 배열, 중첩 테이블, VARARRAY의 세 종류가 있다. 이 글에서는 연관 배열만 알아보는 것으로 한다.



```

-- DECLARE문 안에서

TYPE 연관배열이름 IS TABLE OF 자료형 [NOT NULL]

INDEX BY 인덱스형; -- 성능 이유로 PLS_INTEGER 등의 INTEGER류를 많이 쓴다

```



* 레코드와 컬렉션을 함께 이용하면 테이블을 나타낼 수 있다.

* 여러 컬렉션 메소드를 사용하자.



```

DECLARE

  TYPE DEPT_ARR IS TABLE OF DEPT%ROWTYPE

  INDEX BY PLS_INTEGER;

  

  dept_arr DEPT_ARR;

  idx PLS_INTEGER := 0;

BEGIN

  FOR i IN (SELECT * FROM DEPT) LOOP

    idx := idx + 1;

    dept_arr(idx) := i;

    DBMS_OUTPUT.PUT_LINE(dept_arr(idx).deptno);

  END LOOP;



  DBMS_OUTPUT.PUT_LINE(dept_arr.COUNT);

  DBMS_OUTPUT.PUT_LINE(dept_arr.FIRST); -- 첫 인덱스 번호 반환

  DBMS_OUTPUT.PUT_LINE(dept_arr.LAST);

  DBMS_OUTPUT.PUT_LINE(dept_arr.PRIOR(40)); --40 바로 앞 인덱스 (없으면 NULL) 반환

  DBMS_OUTPUT.PUT_LINE(dept_arr.NEXT(30));

END;

```



3\. 참고자료 / 더 깊이 파보고 싶다면…



[**Do it! 오라클로 배우는 데이터베이스 입문**\

*현업 프로그래머이자 강사인 저자가 수많은 프로젝트 경험을 살려 실무에서 진짜 필요한 기본기를 중심으로 내용을 구성했다. 본문 내용은 비전공자도 알기 쉽게 도해와 비유로 풀어 썼고 427개의 예제는 실무에서 ...*&#x77;ww.aladin.co.kr](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125 "https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125")[](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125)



[**\[Oracle\] PL/SQL 기초7 - 컬렉션(Collection) : VARRAY, Nested Table, 연관 배열, 메소드 등**\

*Oracle\] PL/SQL 기초7 - 컬렉션(Collection) : VARRAY, Nested Table, 연관 배열, 메소드 등 안녕하세요. 갓대희 입니다. 이번 포스팅은 \[ \[Oracle\] PL/SQL 기초…*&#x67;oddaehee.tistory.com](https://goddaehee.tistory.com/263 "https://goddaehee.tistory.com/263")[](https://goddaehee.tistory.com/263)



By [Woohyuk Jang](https://medium.com/@morrranii) on [February 20, 2023](https://medium.com/p/276cb2e71c27).

Exported from [Medium](https://medium.com) on August 26, 2025.
