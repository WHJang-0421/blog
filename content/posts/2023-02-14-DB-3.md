---
title:  "오라클 DB 3: 오라클 단일행 함수"
author: "Woohyuk Jang"
draft: false

date: "2023-02-14"
description: ""
categories:
  - cs/db
tags:
  - Blog
---
### 오라클 DB #3: 오라클 단일행 함수



이 글은 [오라클로 시작하는 데이터베이스 입문](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125) 6장을 읽고 정리한 내용이다.



1. RDBMS에서 함수의 분류



* 단일행 함수: 한 행을 입력으로 받아 한 행을 출력하는 함수. 수학에서 우리가 접한 함수와 비슷하다.

* 다중행 함수: 여러 행을 입력으로 받아 한 행을 출력하는 함수. 여러 행을 요약하는 역할이다.



2\. 문자 함수



앞으로 함수 파라미터에서 \[parameter=value] 꼴은 선택 인자와 기본값을 의미한다.



* UPPER(문자열), LOWER(문자열), INITCAP(문자열): 말 그대로. case-insensitive하게 문자열 비교할 때 잘 쓰인다.

* LENGTH(문자열), LENGTHB(문자열): LENGTHB는 바이트 길이이다. 영어는 1자 1바이트, 한글은 1자 2바이트.

* SUBSTR(문자열, 시작 위치, \[추출 길이 = 끝까지]): 문자열 추출. 시작 위치가 1부터 시작해서 킹받는다. 시작 위치에 음수를 넣으면 뒤에서부터 1로 센다.

* INSTR(문자열, 위치를 찾으려는 문자, \[찾기를 시작하는 위치=1], \[몇번째 등장을 찾는지=1]): 문자의 인덱스를 문자열에서 찾기. 찾기를 시작하는 위치에 음수를 넣으면 뒤에서부터 찾는다. 못 찾으면 0을 반환한다.

* REPLACE(문자열, 찾는 문자, \[대체 문자=‘’]): 문자열에서 문자를 찾아 모두 대체한다.

* LPAD(문자열, 총 자리수, \[채울 문자=‘ ’]), RPAD(동일형식): 왼쪽/오른쪽을 패딩한다.

* CONCAT(문자열, 문자열): concatenation. 두 문자열을 합친다. 문자열 || 문자열처럼 || 연산자를 쓸 수도 있다.

* TRIM( \[삭제 옵션=BOTH] \[삭제 문자=‘ ’] FROM 문자열): 문자열 비교 전 혹시 있을지 모르는 공백 제거용으로 자주 쓰인다. 삭제 옵션에는 LEADING, TRAILING, BOTH가 있다.

* LTRIM(문자열, \[삭제 문자 집합=‘ ’]), RTRIM(동일 형식): 왼쪽/오른쪽에서 지정 문자를 삭제한다. LTRIM(문자열, ‘ad’)처럼 하면 가장 왼쪽에 있는 a 또는 d들을 지우는거다.



3\. 숫자 함수



* ROUND(숫자, \[반올림 위치=0]): 반올림 위치가 0이면 소수점 첫째 자리, -1이면 자연수 첫째자리, 1이면 소수점 둘째자리에서 반올림.

* TRUNC(숫자, \[버림 위치=0]): 버림

* CEIL(숫자), FLOOR(숫자): 정수 올림/버림

* MOD(숫자, 숫자): MOD(A, B)는 A % B



4\. 날짜 연산/함수



날짜는 윤년 등의 여러 복잡한 부분이 많다. 내장 기능을 쓰자.



* 날짜 + 1, 날짜 - 1: 날짜에서 하루 더하고 빼기

* 날짜 - 날짜: 날짜 사이의 차이를 일수로

* 날짜 + 날짜: 연산 불가 (상식적으로 당연)

* ADD\_MONTHS(날짜, 개월 수)

* MONTHS\_BETWEEN(날짜1, 날짜2): 날짜1 - 날짜2를 개월수로

* NEXT\_DAY(날짜, 요일 문자): 돌아오는 요일의 날짜

* LAST\_DAY(날짜): 달의 마지막 날짜

* ROUND(날짜, 반올림 포맷), TRUNC(날짜, 버림 포맷): 숫자와 비슷하다. CC(세기), YYYY, MONTH 등의 여러 기준이 있다.



5\. 형 변환 함수



* 문자 데이터를 중심으로 숫자 데이터와 날짜 데이터의 변환이 가능하다.

* TO\_CHAR(날짜, 출력 포맷): 대표적 포맷은 ‘YYYY/MM/DD HH24:MI:SS’. MM, DD는 월, 일을 숫자로 표현해준다.

* TO\_CHAR(숫자, 출력 포맷): ‘9’는 채우지 않는 숫자의 한 자리, ‘0’은 채우는 숫자의 한 자리를 의미한다. 예를 들어 TO\_CHAR(5243, ‘999,999’)의 결과는 ‘5,243’

* TO\_NUMBER(문자, 변환 포맷): 출력 포맷과 동일 포맷 사용

* TO\_DATE(문자, 변환 포맷): 출력 포맷과 동일 포맷 사용

* 날짜-문자열 변환 포맷에서 YY와 RR은 이슈가 좀 있다. YYYY/RRRR을 사용하자.



6\. NULL 처리 함수



NVL(NULL일수 있는 열, NULL이면 채울 값): NULL Value의 줄임말.



NVL2(NULL일수 있는 열, NULL이 아니면 채울 값, NULL이면 채울 값)



7\. 제어문



오라클에서만 제공하는 DECODE 함수와 표준 SQL에 해당하는 CASE문이 있다.



* DECODE(열, 조건1, 조건1 만족시 반환값, 조건2, 조건2 만족시 반환값, …, \[조건 만족 안할때 반환값=NULL])

* CASE문



```

SELECT

  COL1,

  CASE

    WHEN COL2 IS NULL THEN 'Does not exist'

    ELSE COL2

  END AS COL2_WITH_NULL_SUPPORT

FROM DATATABLE;

```



키워드 CASE, WHEN, THEN, ELSE, END를 기억하자.



8\. 참고자료



[**Do it! 오라클로 배우는 데이터베이스 입문**\

*현업 프로그래머이자 강사인 저자가 수많은 프로젝트 경험을 살려 실무에서 진짜 필요한 기본기를 중심으로 내용을 구성했다. 본문 내용은 비전공자도 알기 쉽게 도해와 비유로 풀어 썼고 427개의 예제는 실무에서 ...*&#x77;ww.aladin.co.kr](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125 "https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125")[](https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171630125)



By [Woohyuk Jang](https://medium.com/@morrranii) on [February 14, 2023](https://medium.com/p/87d672195b90).

Exported from [Medium](https://medium.com) on August 26, 2025.
